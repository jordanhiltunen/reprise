<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.36
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="reprise">Reprise</h1>

<p><a href="https://github.com/jordanhiltunen/reprise/actions/workflows/test.yml"><img src="https://github.com/jordanhiltunen/reprise/actions/workflows/test.yml/badge.svg" alt="Tests"></a> | <a href="https://github.com/jordanhiltunen/reprise/actions/workflows/cruby-build-and-install.yml"><img src="https://github.com/jordanhiltunen/reprise/actions/workflows/cruby-build-and-install.yml/badge.svg" alt="Test CRuby Gem Build"></a></p>

<p>Reprise is an experimental performance-first Ruby gem that provides support for defining event recurrence
rules and generating &amp; querying their future occurrences. Depending on your use case, 
you may benefit from a speedup of up to 1000x relative to other recurrence rule gems: because
Reprise is a thin Ruby wrapper around an extension written in Rust, we are able to offer a level
of speed and conservative memory use that we would otherwise be unable to accomplish in
pure Ruby alone.</p>

<p>For more on why and when you might want to use this gem, see <a href="#why-reprise">Why Reprise?</a>.</p>

<h2 id="installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reprise</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h2 id="usage">Usage</h2>

<p><em>For a complete reference of all of the methods and options available, you can read find the documentation here.</em></p>

<h3 id="initialize-a-new-schedule">Initialize a new schedule</h3>

<p>All schedules need to be initialized with a <code>start_time</code> and <code>end_time</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2015-05-26 10:30:45</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; Tue, 26 May 2015 16:30:45.000000000 CEST +02:00
</span>
<span class='id identifier rubyid_schedule'>schedule</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Reprise.html" title="Reprise (module)">Reprise</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Reprise/Schedule.html" title="Reprise::Schedule (class)">Schedule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Reprise/Schedule.html#initialize-instance_method" title="Reprise::Schedule#initialize (method)">new</a></span></span><span class='lparen'>(</span>
  <span class='label'>starts_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span><span class='comma'>,</span> 
  <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span>
<span class='rparen'>)</span>
</code></pre>

<p>If your <code>starts_at</code> is an <code>ActiveSupport::TimeWithZone</code>, your schedule will infer its time zone from
that value. You can also explicitly pass in a <code>time_zone</code> if your schedule bookends don&#39;t have time zone
information (e.g. if you are passing in simple <code>Time</code> instances):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Reprise.html" title="Reprise (module)">Reprise</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Reprise/Schedule.html" title="Reprise::Schedule (class)">Schedule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Reprise/Schedule.html#initialize-instance_method" title="Reprise::Schedule#initialize (method)">new</a></span></span><span class='lparen'>(</span>
  <span class='label'>starts_at:</span> <span class='id identifier rubyid_may_26_2015_ten_thirty_pm_utc'>may_26_2015_ten_thirty_pm_utc</span><span class='comma'>,</span> 
  <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_ten_thirty_pm_utc'>may_26_2015_ten_thirty_pm_utc</span> <span class='op'>+</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='comma'>,</span>
  <span class='label'>time_zone:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span>
<span class='rparen'>)</span>
</code></pre>

<h3 id="add-recurring-event-series">Add recurring event series</h3>

<p>You can add any number of recurring series to the schedule via <code>repeat_*</code> methods:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_weekly'>repeat_weekly</span><span class='lparen'>(</span><span class='symbol'>:sunday</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>15</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
<span class='comment'># =&gt; 52
</span></code></pre>

<h4 id="customizing-the-time-of-day-for-a-recurring-series-occurrences">Customizing the time of day for a recurring series&#39; occurrences</h4>

<p>By default, all series that advance in units of a day or greater will use the time that your schedule
started at as the local time for each future occurrence:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_first_occurrence'>first_occurrence</span> <span class='op'>=</span> <span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-31T14:30:45+00:00&quot; end_time=&quot;2015-05-31T14:45:45+00:00&quot; label=&quot;nil&quot;&gt;
</span><span class='id identifier rubyid_first_occurrence'>first_occurrence</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; Sun, 31 May 2015 16:30:45.000000000 CEST +02:00 # &lt;- 4:30 PM
</span></code></pre>

<p>You can override this behaviour, and set a custom time of day for each of your series,
either by passing an hour/minute/second hash to <code>time_of_day</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_weekly'>repeat_weekly</span><span class='lparen'>(</span><span class='symbol'>:sunday</span><span class='comma'>,</span> <span class='label'>time_of_day:</span> <span class='lbrace'>{</span> <span class='label'>hour:</span> <span class='int'>9</span><span class='comma'>,</span> <span class='label'>minute:</span> <span class='int'>30</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>60</span><span class='rparen'>)</span>
<span class='id identifier rubyid_first_occurrence'>first_occurrence</span> <span class='op'>=</span> <span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='comment'># =&gt; =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-31T07:30:00+00:00&quot; end_time=&quot;2015-05-31T07:31:00+00:00&quot; label=&quot;nil&quot;&gt;
</span><span class='id identifier rubyid_first_occurrence'>first_occurrence</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; Sun, 31 May 2015 09:30:00.000000000 CEST +02:00
</span></code></pre>

<p>Or, by passing a <code>Time</code> object instead:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ten_forty_five_pm_in_rome'>ten_forty_five_pm_in_rome</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2015-05-27 04:45:00</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_weekly'>repeat_weekly</span><span class='lparen'>(</span><span class='symbol'>:tuesday</span><span class='comma'>,</span> <span class='label'>time_of_day:</span> <span class='id identifier rubyid_ten_forty_five_pm_in_rome'>ten_forty_five_pm_in_rome</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>60</span><span class='rparen'>)</span>
<span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-06-02T08:45:00+00:00&quot; end_time=&quot;2015-06-02T08:46:00+00:00&quot; label=&quot;nil&quot;&gt;
</span><span class='id identifier rubyid_first_occurrence'>first_occurrence</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; Tue, 02 Jun 2015 10:45:00.000000000 CEST +02:00
</span></code></pre>

<h4 id="customizing-the-bookends-of-a-recurring-series">Customizing the bookends of a recurring series</h4>

<p>By default, all series will inherit the <code>starts_at</code> and <code>ends_at</code> values of their parent schedule:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Reprise.html" title="Reprise (module)">Reprise</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Reprise/Schedule.html" title="Reprise::Schedule (class)">Schedule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Reprise/Schedule.html#initialize-instance_method" title="Reprise::Schedule#initialize (method)">new</a></span></span><span class='lparen'>(</span>
  <span class='label'>starts_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span><span class='comma'>,</span> 
  <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>200</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span>
<span class='rparen'>)</span>

<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_weekly'>repeat_weekly</span><span class='lparen'>(</span><span class='symbol'>:wednesday</span><span class='comma'>,</span> <span class='label'>time_of_day:</span> <span class='lbrace'>{</span> <span class='label'>hour:</span> <span class='int'>9</span><span class='comma'>,</span> <span class='label'>minute:</span> <span class='int'>30</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>10</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
<span class='id identifier rubyid_occurrences'>occurrences</span> <span class='op'>=</span> <span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
<span class='comment'># =&gt; 29
</span><span class='id identifier rubyid_puts'>puts</span> <span class='lparen'>(</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_to_date'>to_date</span> <span class='op'>-</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_to_date'>to_date</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='comment'># =&gt; 196 # days
</span></code></pre>

<p>You can also specify the bookends of each recurring series:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_weekly'>repeat_weekly</span><span class='lparen'>(</span>
  <span class='symbol'>:friday</span><span class='comma'>,</span> 
  <span class='label'>time_of_day:</span> <span class='lbrace'>{</span> <span class='label'>hour:</span> <span class='int'>4</span><span class='comma'>,</span> <span class='label'>minute:</span> <span class='int'>01</span> <span class='rbrace'>}</span><span class='comma'>,</span> 
  <span class='label'>duration_in_seconds:</span> <span class='int'>40</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='comma'>,</span>
  <span class='label'>starts_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>40</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span>
  <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>100</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span>
<span class='rparen'>)</span>
<span class='id identifier rubyid_occurrences'>occurrences</span> <span class='op'>=</span> <span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
<span class='comment'># =&gt; 8
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># 2015-07-10 04:01:00 +0200
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_in_time_zone'>in_time_zone</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rome</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># 2015-08-28 04:01:00 +0200
</span><span class='id identifier rubyid_puts'>puts</span> <span class='lparen'>(</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_to_date'>to_date</span> <span class='op'>-</span> <span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_to_date'>to_date</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='comment'># =&gt; 49 # days
</span></code></pre>

<p>There are many recurring series that you can create; <code>#repeat_minutely</code>, <code>#repeat_hourly</code>, 
<code>#repeat_daily</code>, <code>#repeat_weekly</code>, <code>#repeat_monthly_by_day</code>, and <code>#repeat_monthly_by_nth_weekday</code>.</p>

<p>For more information on each method, see the docs.</p>

<h4 id="adding-labels-to-the-occurrences-of-each-series">Adding labels to the occurrences of each series</h4>

<p>If you need to disambiguate occurrences from different series in the same schedule,
you can add an optional label:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_daily'>repeat_daily</span><span class='lparen'>(</span><span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Coffee Time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>time_of_day:</span> <span class='lbrace'>{</span> <span class='label'>hour:</span> <span class='int'>8</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>15</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_daily'>repeat_daily</span><span class='lparen'>(</span><span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tea Time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='int'>3</span><span class='comma'>,</span> <span class='label'>time_of_day:</span> <span class='lbrace'>{</span> <span class='label'>hour:</span> <span class='int'>9</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>10</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_take'>take</span><span class='lparen'>(</span><span class='int'>7</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='rbrace'>}</span>
<span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Coffee Time&quot; start_time=&quot;2015-05-27T06:00:00+00:00&quot; end_time=&quot;2015-05-27T06:15:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Tea Time&quot; start_time=&quot;2015-05-27T07:00:00+00:00&quot; end_time=&quot;2015-05-27T07:10:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Coffee Time&quot; start_time=&quot;2015-05-28T06:00:00+00:00&quot; end_time=&quot;2015-05-28T06:15:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Coffee Time&quot; start_time=&quot;2015-05-29T06:00:00+00:00&quot; end_time=&quot;2015-05-29T06:15:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Coffee Time&quot; start_time=&quot;2015-05-30T06:00:00+00:00&quot; end_time=&quot;2015-05-30T06:15:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Tea Time&quot; start_time=&quot;2015-05-30T07:00:00+00:00&quot; end_time=&quot;2015-05-30T07:10:00+00:00&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence label=&quot;Coffee Time&quot; start_time=&quot;2015-05-31T06:00:00+00:00&quot; end_time=&quot;2015-05-31T06:15:00+00:00&quot;&gt;
</span></code></pre>

<h4 id="excluding-time-intervals-from-the-schedules-occurrences">Excluding time intervals from the schedule&#39;s occurrences</h4>

<p>If you have other non-recurring &quot;schedule entries&quot; in your domain that can collide with your recurring series&#39;
occurrences and need to be excluded, you can add exclusions to your schedule before generating occurrences:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_daily'>repeat_daily</span><span class='lparen'>(</span><span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Standing Meeting</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>5</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>15</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='rbrace'>}</span>
<span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-26T14:30:45+00:00&quot; end_time=&quot;2015-05-26T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-27T14:30:45+00:00&quot; end_time=&quot;2015-05-27T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-28T14:30:45+00:00&quot; end_time=&quot;2015-05-28T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-29T14:30:45+00:00&quot; end_time=&quot;2015-05-29T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-30T14:30:45+00:00&quot; end_time=&quot;2015-05-30T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span>
<span class='comment'># You don&#39;t need to specify entire days; you can pass time intervals as narrow or wide as you like.
</span><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_add_exclusion'>add_exclusion</span><span class='lparen'>(</span>
  <span class='label'>starts_at:</span> <span class='lparen'>(</span><span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_beginning_of_day'>beginning_of_day</span><span class='comma'>,</span>
  <span class='label'>ends_at:</span> <span class='lparen'>(</span><span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_end_of_day'>end_of_day</span>
<span class='rparen'>)</span>

<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences'>occurrences</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='rbrace'>}</span>
<span class='comment'># N.B. The occurrence on 2015-05-28 is now excluded.
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-26T14:30:45+00:00&quot; end_time=&quot;2015-05-26T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-27T14:30:45+00:00&quot; end_time=&quot;2015-05-27T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-29T14:30:45+00:00&quot; end_time=&quot;2015-05-29T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span><span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-30T14:30:45+00:00&quot; end_time=&quot;2015-05-30T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span></code></pre>

<h4 id="querying-for-occurrences-within-a-given-time-interval">Querying for occurrences within a given time interval</h4>

<p>After constructing your schedule, you can query for the occurrences within any interval
of time:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_repeat_daily'>repeat_daily</span><span class='lparen'>(</span><span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Standing Meeting</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>ends_at:</span> <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>5</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span> <span class='label'>duration_in_seconds:</span> <span class='int'>15</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>

<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurs_between?'>occurs_between?</span><span class='lparen'>(</span>
  <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span>
  <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>3</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span>
<span class='rparen'>)</span>
<span class='comment'># =&gt; true
</span>
<span class='id identifier rubyid_schedule'>schedule</span><span class='period'>.</span><span class='id identifier rubyid_occurrences_between'>occurrences_between</span><span class='lparen'>(</span>
  <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span>
  <span class='id identifier rubyid_may_26_2015_four_thirty_pm_in_rome'>may_26_2015_four_thirty_pm_in_rome</span> <span class='op'>+</span> <span class='int'>3</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='comma'>,</span>
<span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='rbrace'>}</span>
<span class='comment'># =&gt; &lt;Reprise::Core::Occurrence start_time=&quot;2015-05-28T14:30:45+00:00&quot; end_time=&quot;2015-05-28T14:45:45+00:00&quot; label=&quot;Standing Meeting&quot;&gt;
</span></code></pre>

<p>Both <code>#occurs_between?</code> and <code>#occurrences_between</code> also support an optional <code>include_overlapping</code>
argument, which allows you to search for occurrences that not only occur entirely within a given
interval, but also those that partially overlap.</p>

<h2 id="why-reprise">Why Reprise?</h2>

<h3 id="first-consider-the-alternatives">First, consider the alternatives</h3>

<p>Reprise is particularly indebted to <a href="https://github.com/ice-cube-ruby/ice_cube">ice_cube</a> and <a href="https://github.com/rossta/montrose">Montrose</a>, projects that have served the Ruby community for years.
They are stable and battle-tested. If you have no actual business need for the kind of performance that Reprise aims for,
you would probably be much better served by choosing one of those two gems instead.</p>

<h3 id="tradeoffs">Tradeoffs</h3>

<ul>
<li><strong>Flexibility.</strong> Because Reprise calls into a strictly-typed extension, its current public interface is very much &quot;one-size-fits-all&quot;;
the influence of Rust leaks into its Ruby API. Alternative gems offer much more flexible APIs that support a variety
of more idiomatic calling conventions: they have better, more forgiving ergonomics. Reprise may invest more efforts
here in the future, but not until we have landed on a feature-complete, performant core - our primary design goal. 
Until then, out API will remain sparse but sufficient.</li>
<li><strong>Stability.</strong> Reprise is still experimental; we do not yet have a <code>1.0.0</code> release or a public roadmap. Breaking changes
may be frequent across releases. If you do not want to pin Reprise to a specific version and want a library that you can
upgrade without reviewing the changelog, you may want to consider an alternative for now.</li>
<li><strong>Serialization.</strong> We do not yet offer any form of persistence support (e.g. parsing from / serializing to yaml / hash
/ ical / others). </li>
</ul>

<h3 id="advantages">Advantages</h3>

<h4 id="performance">Performance</h4>

<p>A truism in the Ruby community is that &quot;Ruby is slow, but that doesn&#39;t matter for you&quot;:</p>

<blockquote>
<p>So, often it hardly matters that [Ruby] is slow, because your use-case does not need the scale,
speed, or throughput that Ruby chokes on. Or because the trade-offs are worth it: Often the
quicker development, cheaper development, faster time-to-market etc is worth the extra resources
(servers, hardware, SAAS) you must throw at your app to keep it performing acceptable.
<a href="https://berk.es/2022/08/09/ruby-slow-database-slow/">https://berk.es/2022/08/09/ruby-slow-database-slow/</a></p>
</blockquote>

<p>This is often delightfully true, until on the odd occasion Ruby&#39;s speed requires that a straightforward feature
be implemented in a contorted or meaningfully-constrained way in order to work.</p>

<p>Reprise aims to solve a niche problem: cutting the latency of recurring schedule generation when it is in
the critical path without imposing an additional complexity burden on clients. For most applications
that deal with recurring events, this is probably not a problem. But if it is, we want to buy you more
effectively-free per-request headroom that you can spend in simple Ruby to improve or ship a feature that
you otherwise couldn&#39;t.</p>

<h5 id="benchmarks">Benchmarks</h5>

<p>You can run benchmarks locally via <code>bundle exec rake benchmark</code>; additionally, 
to view our recent benchmarking results in CI, see <a href="https://github.com/jordanhiltunen/reprise/actions/workflows/benchmark.yml">past runs of our Benchmark worfklow</a>.</p>

<p>Below is a sample local benchmark run taken on the following development machine:</p>

<table><thead>
<tr>
<th>System Detail</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>OS</td>
<td>macOS 14.5 (23F79)</td>
</tr>
<tr>
<td>CPU</td>
<td>2.4 GHz 8-Core Intel i9</td>
</tr>
<tr>
<td>Memory</td>
<td>64GB 2667 MHz DDRr</td>
</tr>
<tr>
<td>Ruby Version</td>
<td>3.3.2 (2024-05-30 revision e5a195edf6) [x86_64-darwin23]</td>
</tr>
<tr>
<td>Rust Version</td>
<td>rustc 1.79.0 (129f3b996 2024-06-10)</td>
</tr>
</tbody></table>

<p><code>benchmark-ips</code>: (higher is better)</p>

<pre class="code ruby"><code class="ruby">ruby 3.3.2 (2024-05-30 revision e5a195edf6) [x86_64-darwin23]
Warming up --------------------------------------
             IceCube     1.000 i/100ms
            Montrose     1.000 i/100ms
             Reprise     1.197k i/100ms
Calculating -------------------------------------
             IceCube     10.259 (± 9.7%) i/s -     52.000 in   5.081337s
            Montrose     14.986 (± 6.7%) i/s -     75.000 in   5.022293s
             Reprise     13.127k (±19.9%) i/s -     63.441k in   5.047277s
</code></pre>

<p><code>benchmark-memory</code>: (lower is better)</p>

<pre class="code ruby"><code class="ruby">Calculating -------------------------------------
             IceCube    10.986M memsize (     1.040k retained)
                       202.268k objects (    14.000  retained)
                         5.000  strings (     1.000  retained)
            Montrose     9.799M memsize (     3.792k retained)
                       157.675k objects (    13.000  retained)
                        34.000  strings (     7.000  retained)
             Reprise    14.872k memsize (     0.000  retained)
                       310.000  objects (     0.000  retained)
                         0.000  strings (     0.000  retained)

Comparison:
             Reprise:      14872 allocated
            Montrose:    9799288 allocated - 658.91x more
             IceCube:   10986192 allocated - 738.72x more
</code></pre>

<h4 id="exclusion-handling">Exclusion Handling</h4>

<p>Beyond performance, one area where Reprise shines is in schedule exclusion handling:</p>

<p>Suppose you have a recurring series that occurs every Monday from 12:30 PM - 1:00 PM. You need to generate
future occurrences of this series, excluding those that do not conflict with pre-existing, non-recurring
schedule entries; e.g. on one particular Monday, you have schedule entries at 9:00 AM - 9:30 AM, 12:15 PM - 1:00 PM, 
and 3:30 - 4:30 PM.</p>

<p>How do you filter out recurring series occurrences that conflict with other schedule entries that exist
in your application?</p>

<p>At time of writing, alternative gems&#39; solutions to this problem are all unfortunately lacking:</p>

<ul>
<li><strong>None</strong>: It is entirely the responsibility of the client application to handle occurrence exclusions,
despite this logic being core to the domain of recurring schedule management.</li>
<li><strong>Date-based exclusion</strong>: Client applications can pass specific dates when occurrences should be excluded.
This is not sufficient except for in the most simple of circumstances. Again, consider our hypothetical
Monday @ 12:30 PM recurring series: being able to exclude a specific <em>date</em> from your recurrence rule still 
requires you to implement your own overlap detection logic to determine whether an occurrence actually conflicts with
the start and end times of a schedule entry on a given date. </li>
</ul>

<p>These limitations can push a significant amount of schedule recurrence logic onto client applications;
Reprise improves on this significantly by offering an API to define exclusions with start and end times; Reprise
then determines whether any given occurrence overlaps with an exclusion that you have defined, and filters
them out during occurrence generation accordingly.</p>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>Reprise, a Ruby gem with a Rust core, is only possible because of the foundation laid by the excellent <a href="https://github.com/matsadler/magnus">Magnus</a> project.</p>

<h2 id="development">Development</h2>

<p>To get started after checking out the repo:</p>

<pre class="code bash"><code class="bash">$ bin/setup # install dependencies
$ rake compile:reprise # recompile the extension after making changes to Rust files
$ rake spec # run the test suite
$ rake benchmark # run the benchmarks
</code></pre>

<h3 id="generating-documentation">Generating Documentation</h3>

<p>Reprise&#39; public Ruby API is documented using <a href="https://yardoc.org/guides/">YARD</a>.
To regenerate the documentation after changing any of the annotations, run <code>rake yard</code>
and commit the changes.</p>

<h2 id="contributing">Contributing</h2>

<p>This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="http://contributor-covenant.org">Contributor Covenant</a> code of conduct.</p>

<ul>
<li>:white_check_mark: Report or fix bugs</li>
<li>:white_check_mark: Suggest features</li>
<li>:white_check_mark: Write or improve documentation</li>
<li>:yellow_circle: Submit pull requests (please reach out first)</li>
</ul>

<p>We plan on welcoming pull requests once we settle on an initial <code>1.0.0</code>; until then, we anticipate
a lot of early experimentation, and we will have more time to collaborate and welcome pull requests
once we&#39;ve hit that milestone.</p>

<h2 id="license">License</h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/MIT">MIT License</a>.</p>

<h2 id="code-of-conduct">Code of Conduct</h2>

<p>Everyone interacting in the Reprise project’s codebases, issue trackers, chat rooms and mailing lists is expected to follow the <a href="https://github.com/jordanhiltunen/reprise/blob/master/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
</div></div>

      <div id="footer">
  Generated on Sat Jul 20 10:33:49 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.36 (ruby-3.3.2).
</div>

    </div>
  </body>
</html>